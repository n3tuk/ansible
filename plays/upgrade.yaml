---
# Upgrade all the installed packages on all virtual, and the physical hosts,
# updating the virtual hosts first and completely before updating the physical
# hosts.

- name: Update all machines
  ansible.builtin.import_playbook: update.yaml

- name: Upgrade all virtual machines
  hosts: virtual
  become: true
  become_user: root
  tasks:
    - name: Upgrade all avilable packages
      community.general.pacman:
        upgrade: true
  tags:
    - virtual-machines

- name: Upgrade all physical machines
  hosts: physical
  become: true
  become_user: root
  tasks:
    - name: Upgrade all avilable packages
      community.general.pacman:
        upgrade: true
  tags:
    - physical-machines
